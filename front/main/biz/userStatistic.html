<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-store">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>云护健康管理平台-用户</title>

    <!-- 全局样式 -->
    <link href="../../assets/css/icons/icomoon/styles.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/icons/fontawesome/styles.min.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/core.min.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/components.min.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/colors.min.css" rel="stylesheet" type="text/css">
    <link href="../../assets/css/statistic/account.css" rel="stylesheet"/>
    <link href="../../assets/css/statistic/bootstrap-datetimepicker.min.css" rel="stylesheet"/>
    <!-- /全局样式 -->

    <!-- 自定义样式 -->
    <link href="../../extends/css/common.css" rel="stylesheet" type="text/css">
    <link href="../../extends/css/admin/user.css" rel="stylesheet" type="text/css">
    <!-- /自定义样式 -->

    <!-- js核心库 -->
    <script type="text/javascript" src="../../assets/js/core/libraries/vue.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/loaders/pace.min.js"></script>
    <script type="text/javascript" src="../../assets/js/core/libraries/jquery.min.js"></script>
    <script type="text/javascript" src="../../assets/js/core/libraries/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/loaders/blockui.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/notifications/pnotify.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/notifications/bootbox.min.js"></script>
    <!-- /js核心库 -->

    <!-- js主题库 -->
    <script type="text/javascript" src="../../assets/js/plugins/forms/selects/select2.min.js"></script>
    <script type="text/javascript" src="../../assets/js/core/libraries/jquery_ui/core.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/forms/selects/selectboxit.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/forms/styling/uniform.min.js"></script>

    <script type="text/javascript" src="../../assets/js/plugins/tables/datatables/datatables.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/tables/datatables/extensions/select.min.js"></script>
    <script type="text/javascript"
            src="../../assets/js/plugins/tables/datatables/extensions/jszip/jszip.min.js"></script>
    <script type="text/javascript"
            src="../../assets/js/plugins/tables/datatables/extensions/pdfmake/pdfmake.min.js"></script>
    <script type="text/javascript"
            src="../../assets/js/plugins/tables/datatables/extensions/pdfmake/vfs_fonts.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/tables/datatables/extensions/buttons.min.js"></script>

    <script type="text/javascript" src="../../assets/js/core/app.js"></script>

    <script type="text/javascript" src="../../assets/js/plugins/statistic/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/statistic/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/statistic/bootstrap-datetimepicker.zh-CN.js"></script>

    <!--jQuery Flot Chart-->
    <script type="text/javascript" src="../../assets/js/plugins/statistic/jquery.flot.js"></script>
    <script type="text/javascript" src="../../assets/js/plugins/statistic/jquery.flot.stack.js"></script>


    <!-- /js主题库 -->

    <!-- js自定义 -->
    <script type="text/javascript" src="../../extends/js/common.js"></script>
    <!--<script type="text/javascript" src="../../extends/js/biz/statistic.js"></script>-->
    <!-- /js自定义 -->
</head>

<body>
<!-- 页面容器 -->
<div class="page-container">
    <!-- 页面内容-->
    <div class="page-content">

        <!-- Main content -->
        <div class="content-wrapper">

            <!-- Page header -->
            <div class="page-header page-header-default border-bottom-lg border-bottom-teal">
                <div class="page-header-content">
                    <div class="page-title">
                        <h4><i class="icon-arrow-left52 position-left"></i> <span class="text-bold">业务管理</span> - 用户管理
                        </h4>
                    </div>
                </div>

                <div class="breadcrumb-line">
                    <ul class="breadcrumb">
                        <li><a href="/main/welcome.html"><i class="icon-home2 position-left"></i>首页</a></li>
                        <li>业务管理</li>
                        <li>用户管理</li>
                        <li class="active">用户统计分析</li>
                    </ul>
                </div>
            </div>
            <!-- /page header -->


            <!-- Content area -->
            <div class="content">
                <div class="panel panel-white">
                    <div class="panel-heading">
                        <h5 class="panel-title"><i class="icon-profile position-left"></i>用户统计分析</h5>
                        <!--<div class="heading-elements">
                            <ul class="icons-list">
                                <li><a data-action="reload" data-fnReload="refreshData"></a></li>
                                <li><a data-action="collapse"></a></li>
                            </ul>
                        </div>-->
                    </div>

                </div>
                <form class="form-inline">
                <div class="form-group">
                    <label>统计方式</label>
                    <div class="btn-group">
                        <button id="mm" type="button" name="month" class="btn btn-default active" onclick="Time('month')" style="outline:none;">月</button>
                        <button id="ww" type="button" name="week" class="btn btn-default" onclick="Time('week')" style="outline:none;">周</button>
                        <button id="dd" type="button" name="day" class="btn btn-default" onclick="Time('day')" style="outline:none;">日</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="time-label">选择时间</label>
                    <input type="text" class="form-control form-filter monthpicker" readonly name="inputYear" id="Month" value=""/>
                    <input type="text" class="form-control form-filter weekpicker" readonly name="inputMonth" id="Week" value=""/>
                    <input type="text" class="form-control form-filter daypicker" readonly name="inputDay" id="Day" value=""/>
                </div>

                <!-- <button type="button"  class="btn btn-default" onclick="test()" style="outline:none;">测试</button> -->
                <div class="form-group">
                    <input type="button" class="btn btn-default" value="统计" id="tj">
                </div>
                </form>
                <div id="statsChart" ></div><!--这里放图表折线-->

                <!-- Footer -->
                <!--<div class="footer text-muted" v-html="footer"></div>-->
                <!-- /footer -->
            </div>
            <!-- /content area -->
        </div>
        <!-- /main content -->
    </div>
    <!-- /page content -->
</div>
<script>
    /*$(".yearpicker").click(function(){
        alert("");
    })*/
    $('.monthpicker').datetimepicker({
        startView: 'decade',
        minView: 'decade',
        format: 'yyyy',
        maxViewMode: 2,
        minViewMode:2,
        autoclose: true,
        language: 'zh-CN'
    });
    $('.weekpicker').datetimepicker({
        startView: 'decade',
        minView: 'decade',
        format: 'yyyy',
        maxViewMode: 2,
        minViewMode:2,
        autoclose: true,
        language: 'zh-CN'
    });
    $('.daypicker').datetimepicker({
        format: 'yyyy-mm',
        weekStart: 1,
        autoclose: true,
        startView: 3,
        minView: 3,
        forceParse: false,
        language: 'zh-CN'
    });

    function Time(obj) {
        if (obj == 'month') {
            $("button[name='month']").addClass('active');
            $("button[name='week']").removeClass('active');
            $("button[name='day']").removeClass('active');
            $(".time-label").text("选择年度");
            $("#Week").val("");
            $("#Day").val("");
            $("#Month").show();
            $("#Week").hide();
            $("#Day").hide();

        } else if (obj == 'week') {
            $("button[name='month']").removeClass('active');
            $("button[name='day']").removeClass('active');
            $("button[name='week']").addClass('active');
            $(".time-label").text("选择年度");
            $("#Month").val("");
            $("#Day").val("");
            $("#Month").hide();
            $("#Day").hide();
            $("#Week").show();
        }  else if (obj == 'day') {
            $("button[name='week']").removeClass('active');
            $("button[name='month']").removeClass('active');
            $("button[name='day']").addClass('active');
            $(".time-label").text("选择月份");
            $("#Month").val("");
            $("#Week").val("");
            $("#Month").hide();
            $("#Week").hide();
            $("#Day").show();
        }
    }
    $(function () {

        function showChart(series,seriesData) {

            // jQuery Flot Chart
            //var seriesData = [[1, 50],[2, 40],[3, 45], [4, 23],[5, 55], [6, 65], [7, 61], [8, 70], [9, 65], [10, 75], [11, 57], [12, 59]];
            //alert(seriesData);
            //var visitors = [[1, 25], [2, 50], [3, 23], [4, 48],[5, 38],[6, 40],[7, 47],[8, 55],[9, 43],[10,50],[11,47],[12, 39]];
            //var series = [[1, "JAN"], [2, "FEB"], [3, "MAR"], [4, "APR"], [5, "MAY"], [6, "JUN"], [7, "JUL"], [8, "AUG"], [9, "SEP"], [10, "OCT"], [11, "NOV"], [12, "DEC"]];
            var plot = $.plot($("#statsChart"),
                [
                    //{data: visits, label: "Signups"},
                    {data: seriesData, label: "注册用户数 Registers"}
                ],
                {
                    series: {
                        lines: { show: true,
                            lineWidth: 2,
                            fill: true,
                            fillColor: { colors: [ { opacity: 0.1 }, { opacity: 0.13 } ] }
                        },
                        points: { show: true,
                            lineWidth: 2,
                            radius: 3
                        },
                        shadowSize: 0,
                        stack: true
                    },
                    grid: { hoverable: true,
                        clickable: true,
                        tickColor: "#f9f9f9",
                        borderWidth: 0
                    },
                    legend: {
                        // show: false
                        labelBoxBorderColor: "#fff"
                    },
                    colors: [
                        // "#a7b5c5",
                        "#30a0eb"
                    ],
                    xaxis: {
                        ticks: series,
                        font: {
                            size: 12,
                            family: "Open Sans, Arial",
                            variant: "small-caps",
                            color: "#697695"
                        }
                    },
                    yaxis: {
                        ticks:3,
                        tickDecimals: 0,
                        font: {size:12, color: "#9da3a9"},
                        min: 0
                    }
                });

            function showTooltip(x, y, contents) {
                $('<div id="tooltip">' + contents + '</div>').css( {
                    position: 'absolute',
                    display: 'none',
                    top: y - 30,
                    left: x - 50,
                    color: "#fff",
                    padding: '2px 5px',
                    'border-radius': '6px',
                    'background-color': '#000',
                    opacity: 0.80
                }).appendTo("body").fadeIn(200);
            }

            var previousPoint = null;
            $("#statsChart").bind("plothover", function (event, pos, item) {
                if (item) {
                    if (previousPoint != item.dataIndex) {
                        previousPoint = item.dataIndex;

                        $("#tooltip").remove();
                        var x = item.datapoint[0].toFixed(0),
                            y = item.datapoint[1].toFixed(0);

                        var month = item.series.xaxis.ticks[item.dataIndex].label;

                        showTooltip(item.pageX, item.pageY,
                            item.series.label + " of " + month + " : " + y);
                    }
                }
                else {
                    $("#tooltip").remove();
                    previousPoint = null;
                }
            });
        }
        $("#tj").click(function () {
            if(($("#mm").hasClass("active"))){
                var type = "month";
                var time=$("#Month").val();
                if (time == ''){
                    alert("请选择时间");
                }else {
                $.get("/biz/user/statistics?type="+type+"&time="+time, function(data) {
                    showChart(data.series, data.seriesData);
                    });
                }
            }else if(($("#dd").hasClass("active"))){
                var type="day";
                var time=$("#Day").val();
                if (time == ''){
                    alert("请选择时间");
                }else {
                    $.get("/biz/user/statistics?type=" + type + "&time=" + time, function (data) {
                        showChart(data.series, data.seriesData);
                    });
                }
            }else if(($("#ww").hasClass("active"))){
                var type="week";
                var time=$("#Week").val();
                if (time == ''){
                    alert("请选择时间");
                }else {
                    $.get("/biz/user/statistics?type=" + type + "&time=" + time, function (data) {
                        showChart(data.series, data.seriesData);
                    });
                }
            }

        });


        //var series = [[1, "JAN"], [2, "FEB"], [3, "MAR"], [4,"APR"], [5,"MAY"], [6,"JUN"], [7,"JUL"], [8,"AUG"], [9,"SEP"], [10,"OCT"], [11,"NOV"], [12,"DEC"]];
        //var seriesData = [[1, 50], [2, 40], [3, 45], [4, 23],[5, 55],[6, 65],[7, 61],[8, 70],[9, 65],[10, 75],[11, 57],[12, 59]];

    })



</script>
<!-- /页面容器 -->
</body>
</html>
